<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Hooks</title>

        <link href="/normalize.css" rel="stylesheet" />
        <link href="/reset.css" rel="stylesheet" />
        <link href="/brixi.css" rel="stylesheet" />
        <link href="/base.css" rel="stylesheet" />

        <script defer src="/prism.js"></script>
        <link href="/prism.css" rel="stylesheet" />

        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet" />

        <script defer src="/nav.js"></script>
        <script defer src="/page-jump-generator.js"></script>
    </head>
    <body>
        <main>
            <aside><nav><a href="/" class="project-name">DjinnJS</a><a href="https://github.com/Pageworks/djinnjs"><span>GitHub</span></a><a href="https://www.npmjs.com/package/djinnjs"><span>NPM</span></a><header>Documents</header><a href="/code-of-conduct" data-slug="/code-of-conduct"><span>code of conduct</span></a><a href="/contributing" data-slug="/contributing"><span>contributing</span></a><a href="/developers" data-slug="/developers"><span>developers</span></a><a href="/readme" data-slug="/readme"><span>readme</span></a><header>core</header><a href="/core/inline-scripts" data-slug="/core/inline-scripts"><span>inline scripts</span></a><a href="/core/messaging" data-slug="/core/messaging"><span>messaging</span></a><a href="/core/pjax" data-slug="/core/pjax"><span>pjax</span></a><a href="/core/progressive-enhancements" data-slug="/core/progressive-enhancements"><span>progressive enhancements</span></a><a href="/core/requesting-css" data-slug="/core/requesting-css"><span>requesting css</span></a><a href="/core/web-components" data-slug="/core/web-components"><span>web components</span></a><header>guides</header><a href="/guides/adding-npm-packages" data-slug="/guides/adding-npm-packages"><span>adding npm packages</span></a><a href="/guides/configuration" data-slug="/guides/configuration"><span>configuration</span></a><a href="/guides/frameworks" data-slug="/guides/frameworks"><span>frameworks</span></a><a href="/guides/installation" data-slug="/guides/installation"><span>installation</span></a><a href="/guides/lazy-loading" data-slug="/guides/lazy-loading"><span>lazy loading</span></a><a href="/guides/quick-start-guide" data-slug="/guides/quick-start-guide"><span>quick start guide</span></a><header>loading states</header><a href="/loading-states/hard" data-slug="/loading-states/hard"><span>hard</span></a><a href="/loading-states/page" data-slug="/loading-states/page"><span>page</span></a><a href="/loading-states/soft" data-slug="/loading-states/soft"><span>soft</span></a><header>messaging system</header><a href="/messaging-system/actors" data-slug="/messaging-system/actors"><span>actors</span></a><a href="/messaging-system/broadcaster" data-slug="/messaging-system/broadcaster"><span>broadcaster</span></a><a href="/messaging-system/hooks" data-slug="/messaging-system/hooks"><span>hooks</span></a><a href="/messaging-system/sending-messages" data-slug="/messaging-system/sending-messages"><span>sending messages</span></a></nav></aside>
            <article><h1 id="hooks">Hooks</h1>
<p>Everything in DjinnJS uses the messaging system and all the Actors play fair by sending messages to themselves. Below is a list of hooks that can be used:</p>
<h2 id="runtime">Runtime</h2>
<p>The Runtime class offers a <code>completed</code> hook that fires after all CSS has been loaded and Web Components moutned.</p>
<pre><code class="javascript language-javascript">inbox(data){
    const { type } = data;
    switch (type) {
        case 'completed':
            // Do something or call a function
            break;
        default:
            return;
    }
}
const inboxUid = hookup('runtime', this.inbox.bind(this));
</code></pre>
<p>The runtime class will send a message to the <code>user-input</code> inbox when the users has a <code>slow-2g</code> or <code>2g</code> or <code>3g</code> connection. Below is an example of how to respond to these messages.</p>
<pre><code class="javascript language-javascript">import { hookup, reply } from "djinnjs/broadcaster";
inbox(data){
    const { type } = data;
    switch (type) {
        case 'lightweight-check':
            // TODO: Prompt the user to select the lite or full version of the website
            const userChoice = getUserInput();
            if (userChoice === 'lite'){
                reply({
                    replyId: data.replyId,
                    type: 'use-lite,
                });
            }else{
                reply({
                    replyId: data.replyId,
                    type: 'use-full,
                });
            }
            break;
        default:
            return;
    }
}
const inboxUid = hookup('user-input', this.inbox.bind(this));
</code></pre>
<h2 id="pjax">Pjax</h2>
<p>The Pjax class offers a <code>completed</code> hook that fires after the page navigaiton has successfully completed. All CSS has been loaded, Web Components mouted, and the windows history has been updated.</p>
<pre><code class="javascript language-javascript">inbox(data){
    const { type } = data;
    switch (type) {
        case 'completed':
            // Do something or call a function
            break;
        default:
            return;
    }
}
const inboxUid = hookup('pjax', this.inbox.bind(this));
</code></pre>
<p>The Pjax class will also send a <code>stale-notification</code> message to the <code>user-input</code> inbox when DjinnJS is using the <code>offline-first</code> service worker (default) and the current page is stale.</p>
<pre><code class="javascript language-javascript">inbox(data){
    const { type } = data;
    switch (type) {
        case 'stale-notification':
            // TODO: prompt the user that a new version of the page is available
            const userResponse = getUserInput();
            if (userResponse === 'refresh-page'){
                location.reload();
            }
            break;
        default:
            return;
    }
}
const inboxUid = hookup('user-input', this.inbox.bind(this));
</code></pre></article>
        </main>
    </body>
</html>
